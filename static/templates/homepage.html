<!DOCTYPE html>
<!-- Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license.
See LICENSE in the source repository root for complete license information. -->
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>open extensions</title>
        <link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="/static/css/site.css?version=1.04" />
    </head>
    <body>
        <div class="container homepage-container">
            <h1>open extensions sample</h1>
            <table class="main-table">
                % if user_identity:
                <tr>
                    <td colspan="2">
                        <p>Select a color preference below, and it will be saved as an open extension. This setting is available any time the same user is authenticated, so it can "roam" with you to other sessions or applications on any browser or device.</p>
                    </td>
                </tr>
                <tr>
                    <td colspan="2"><hr/></td>
                </tr>
                <tr>
                    <td><p><strong>Select color preference:</strong></p>
                        <form action="/">
                            <input type="submit" name="color" value="Red" class="btn btn-danger btn-md colorbutton">
                            <input type="submit" name="color" value="Green" class="btn btn-success btn-md colorbutton">
                            <input type="submit" name="color" value="Blue" class="btn btn-primary btn-md colorbutton">
                        </form>
                    </td>
                    <td id="color-cell" style="background-color: {{color}}">{{ f'color preference for {user_identity}' }}</td>
                </tr>
                <tr><td colspan="2"><hr/></td></tr>
                <tr>
                    <td>
                        <button type="button" class="btn btn-default btn-md" onclick="window.location.href='/logout'">Log Out</button>
                    </td>
                    <td></td>
                </tr>
                % else:
                <tr>
                    <td colspan="2">
                        <p>This sample shows how to use open extensions (custom metadata) in Microsoft Graph.</p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <button type="button" class="btn btn-success btn-md" onclick="window.location.href='/login'">Log In</button>
                    </td>
                    <td></td>
                </tr>
                % end
            </table>
        </div>
    </body>
</html>
